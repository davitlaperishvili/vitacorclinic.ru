import{q as I,f as L,c as O,r as R,p as b,e as w}from"./links.BtZm82fD.js";import"./default-i18n.DXRQgkn2.js";import{u as C,S as A}from"./SeoSiteScore.DCVfob0y.js";import{_ as k}from"./_plugin-vue_export-helper.BN1snXvA.js";import{s as B}from"./helpers.DWk2T5bC.js";import{C as N,a as D}from"./Score.BRQVMD7X.js";import{p as V}from"./popup.6pJEdp0g.js";import{C as M}from"./Blur.CvHKqkVq.js";import{C as T}from"./Card.CHgb8IZx.js";import{v as l,o as c,c as u,B as m,l as h,k as z,m as v,q as P,a as i,t as a,C as g,b as d,F as W,J as j}from"./runtime-dom.esm-bundler.tPRhSV4q.js";import{C as q}from"./SeoSiteAnalysisResults.DkqlDhHS.js";import{C as H}from"./Index.BaLhZdca.js";import{S as G}from"./Refresh.DRpUll-o.js";import{S as F}from"./index.Dbgw3oZ8.js";import"./params.B3T1WKlC.js";import"./Tooltip.DhkkBQWW.js";import"./Caret.Ke5gylGO.js";import"./Slide.fjAuzpC8.js";import"./Tags.Q2tosvUR.js";import"./postSlug.Dk5HaUF7.js";import"./metabox.BOneAUwv.js";import"./cleanForSlug.Ck7GHDA6.js";import"./toString.Cp__a8QI.js";import"./_baseTrim.BYZhh0MR.js";import"./_stringToArray.DnK4tKcY.js";import"./deburr.B1yvcqMY.js";import"./_baseSet.kulGDCqw.js";import"./GoogleSearchPreview.2vgm6x5U.js";import"./constants.CPpKID74.js";import"./Information.Bv8uKEyF.js";import"./Gear.DwDaVskn.js";import"./Index.CuDgGAhK.js";const J={setup(){const{strings:e}=C();return{connectStore:I(),licenseStore:L(),rootStore:O(),strings:e}},components:{CoreBlur:M,CoreCard:T},mixins:[A],data(){return{score:0}},methods:{openPopup(e){V(e,this.connectWithAioseo,600,630,!0,["token"],this.completedCallback,()=>{})},completedCallback(e){return this.connectStore.saveConnectToken(e.token)}}},K={key:0,class:"aioseo-seo-site-score-cta"},Y=["href"];function Q(e,r,o,t,s,n){const _=l("core-card");return c(),u("div",null,[m(_,{slug:"analyzeNewCompetitor","hide-header":"","no-slide":"",toggles:!1},{default:h(()=>[(c(),z(P(t.licenseStore.isUnlicensed?"core-blur":"div"),null,{default:h(()=>[v(e.$slots,"default")]),_:3})),t.licenseStore.isUnlicensed?(c(),u("div",K,[i("a",{href:t.rootStore.aioseo.urls.aio.settings},a(t.strings.enterLicenseKey),9,Y),g(" "+a(t.strings.toAnalyzeCompetitorSite),1)])):d("",!0)]),_:3}),t.licenseStore.isUnlicensed?d("",!0):v(e.$slots,"competitor-results",{key:0})])}const X=k(J,[["render",Q]]),Z={setup(){const{strings:e}=C();return{analyzerStore:R(),composableStrings:e}},components:{CoreSiteScore:H,SvgRefresh:G},mixins:[A],props:{score:Number,loading:Boolean,site:{type:String,required:!0},summary:{type:Object,default(){return{}}},mobileSnapshot:String},data(){return{isAnalyzing:!1,strings:b(this.composableStrings,{criticalIssues:this.$t.__("Important Issues",this.$td),warnings:this.$t.__("Warnings",this.$td),recommendedImprovements:this.$t.__("Recommended Improvements",this.$td),goodResults:this.$t.__("Good Results",this.$td),completeSiteAuditChecklist:this.$t.__("Complete Site Audit Checklist",this.$td),refreshResults:this.$t.__("Refresh Results",this.$td),mobileSnapshot:this.$t.__("Mobile Snapshot",this.$td)})}},methods:{refresh(){this.isAnalyzing=!0,this.analyzerStore.runSiteAnalyzer({url:this.site,refresh:!0}).then(()=>this.isAnalyzing=!1)}}},ee={class:"aioseo-site-score-competitor"},te={class:"aioseo-seo-site-score-score"},se={class:"aioseo-seo-site-score-recommendations"},oe={class:"critical"},re={class:"round red"},ie={class:"recommended"},ne={class:"round blue"},ae={class:"good"},le={class:"round green"},ce={key:0,class:"mobile-snapshot"},me=["src"];function he(e,r,o,t,s,n){const _=l("core-site-score"),S=l("svg-refresh"),f=l("base-button");return c(),u("div",ee,[i("div",te,[m(_,{loading:s.isAnalyzing||o.loading,score:o.score,description:e.description},null,8,["loading","score","description"])]),i("div",se,[i("div",oe,[i("span",re,a(o.summary.critical||0),1),g(" "+a(s.strings.criticalIssues),1)]),i("div",ie,[i("span",ne,a(o.summary.recommended||0),1),g(" "+a(s.strings.recommendedImprovements),1)]),i("div",ae,[i("span",le,a(o.summary.good||0),1),g(" "+a(s.strings.goodResults),1)])]),m(f,{class:"refresh-results",type:"gray",size:"small",onClick:n.refresh,loading:s.isAnalyzing},{default:h(()=>[m(S),g(" "+a(s.strings.refreshResults),1)]),_:1},8,["onClick","loading"]),o.mobileSnapshot?(c(),u("div",ce,[i("div",null,a(s.strings.mobileSnapshot),1),i("img",{alt:"Mobile Snapshot",src:o.mobileSnapshot},null,8,me)])):d("",!0)])}const ue=k(Z,[["render",he]]),pe={setup(){const{strings:e}=C();return{analyzerStore:R(),settingsStore:w(),composableStrings:e}},components:{CoreAnalyze:N,CoreAnalyzeScore:D,CoreAnalyzeCompetitorSiteHeader:X,CoreCard:T,CoreSeoSiteAnalysisResults:q,CoreSiteScoreCompetitor:ue,SvgTrash:F},mixins:[A],data(){return{score:0,competitorUrl:null,isAnalyzing:!1,inputError:!1,competitorResults:{},analyzeTime:8,strings:b(this.composableStrings,{enterCompetitorUrl:this.$t.__("Enter Competitor URL",this.$td),performInDepthAnalysis:this.$t.__("Perform in-depth SEO Analysis of your competitor's website.",this.$td),analyze:this.$t.__("Analyze",this.$td),pleaseEnterValidUrl:this.$t.__("Please enter a valid URL.",this.$td)})}},watch:{"analyzerStore.analyzeError"(e){e&&(this.isAnalyzing=!1)}},computed:{getError(){switch(this.analyzerStore.analyzeError){case"invalid-url":return this.$t.__("The URL provided is invalid.",this.$td);case"missing-content":return this.$t.sprintf("%1$s %2$s",this.$t.__("We were unable to parse the content for this site.",this.$td),this.$links.getDocLink(this.$constants.GLOBAL_STRINGS.learnMore,"seoAnalyzerIssues",!0));case"invalid-token":return this.$t.sprintf(this.$t.__("Your site is not connected. Please connect to %1$s, then try again.",this.$td),"AIOSEO")}return this.analyzerStore.analyzeError}},methods:{parseResults(e){return JSON.parse(e)},getSummary(e){return{recommended:this.analyzerStore.recommendedCount(e),critical:this.analyzerStore.criticalCount(e),good:this.analyzerStore.goodCount(e)}},startAnalyzing(e){if(this.inputError=!1,this.competitorUrl=e,!this.competitorUrl.startsWith("http://")&&!this.competitorUrl.startsWith("https")&&(this.competitorUrl="https://"+this.competitorUrl),!B(this.competitorUrl)){this.inputError=!0;return}this.analyzerStore.analyzing=!0,this.analyzerStore.analyzeError=!1,this.analyzerStore.runSiteAnalyzer({url:this.competitorUrl}),this.isAnalyzing=!0,setTimeout(this.checkStatus,this.analyzeTime*1e3),this.closeAllCards()},checkStatus(){if(this.isAnalyzing=!1,this.analyzerStore.analyzing){this.$nextTick(()=>{this.isAnalyzing=!0,2>this.analyzeTime&&(this.analyzeTime=8),this.analyzeTime=this.analyzeTime/2,setTimeout(this.checkStatus,this.analyzeTime*1e3)});return}this.$nextTick(()=>{this.competitorResults=this.analyzerStore.getCompetitorSiteAnalysisResults;const e=Object.keys(this.competitorResults),r=document.querySelector(".aioseo-header"),o=r.offsetHeight+r.offsetTop+30,t=e.indexOf(this.competitorUrl)===-1?0:e.indexOf(this.competitorUrl);this.toggleCard(t),this.$scrollTo("#aioseo-competitor-results"+this.hashCode(e[t]),{offset:-o}),this.competitorUrl=null})},startDeleteSite(e){this.closeAllCards(),delete this.competitorResults[e],this.analyzerStore.deleteCompetitorSite(e).then(()=>{this.competitorResults=this.analyzerStore.getCompetitorSiteAnalysisResults})},closeAllCards(){Object.keys(this.competitorResults).forEach(r=>{this.settingsStore.closeCard("analyzeCompetitorSite"+r)})},toggleCard(e){const r=Object.keys(this.competitorResults);this.settingsStore.toggleCard({slug:"analyzeCompetitorSite"+r[e]})},hashCode(e){if(!e)return;let r=0,o,t;for(o=0;o<e.length;o++)t=e.charCodeAt(o),r=(r<<5)-r+t,r|=0;return r}},mounted(){this.analyzerStore.analyzeError=!1,this.competitorResults=this.analyzerStore.getCompetitorSiteAnalysisResults,this.toggleCard(0)}},de={class:"aioseo-analyze-competitor-site"},_e={key:0,class:"aioseo-description aioseo-error"},ye=["innerHTML"],ge={class:"competitor-results-main"},Se={class:"competitor-results-body"};function fe(e,r,o,t,s,n){const _=l("core-analyze"),S=l("core-analyze-score"),f=l("svg-trash"),U=l("core-site-score-competitor"),E=l("core-seo-site-analysis-results"),$=l("core-card"),x=l("core-analyze-competitor-site-header");return c(),u("div",de,[m(x,null,{"competitor-results":h(()=>[(c(!0),u(W,null,j(s.competitorResults,(y,p)=>(c(),z($,{key:p,id:"aioseo-competitor-results"+n.hashCode(p),slug:"analyzeCompetitorSite"+p,"save-toggle-status":!1},{header:h(()=>[m(S,{score:n.parseResults(y).score},null,8,["score"]),i("span",null,a(p),1),s.isAnalyzing?d("",!0):(c(),z(f,{key:0,onClick:ze=>n.startDeleteSite(p)},null,8,["onClick"]))]),default:h(()=>[i("div",ge,[m(U,{site:p,score:n.parseResults(y).score,loading:t.analyzerStore.analyzing,summary:n.getSummary(n.parseResults(y).results),"mobile-snapshot":n.parseResults(y).results.advanced.mobileSnapshot},null,8,["site","score","loading","summary","mobile-snapshot"]),i("div",Se,[m(E,{section:"all-items","all-results":n.parseResults(y).results,"show-google-preview":""},null,8,["all-results"])])])]),_:2},1032,["id","slug"]))),128))]),default:h(()=>[m(_,{header:s.strings.enterCompetitorUrl,description:s.strings.performInDepthAnalysis,inputError:s.inputError,isAnalyzing:s.isAnalyzing,analyzeTime:s.analyzeTime,placeholder:"https://competitorwebsite.com",onStartAnalyzing:n.startAnalyzing},{errors:h(()=>[s.inputError?(c(),u("div",_e,a(s.strings.pleaseEnterValidUrl),1)):d("",!0),t.analyzerStore.analyzer==="competitor-site"&&t.analyzerStore.analyzeError?(c(),u("div",{key:1,class:"analyze-errors aioseo-description aioseo-error",innerHTML:t.analyzerStore.analyzeError},null,8,ye)):d("",!0)]),_:1},8,["header","description","inputError","isAnalyzing","analyzeTime","onStartAnalyzing"])]),_:1})])}const Ze=k(pe,[["render",fe]]);export{Ze as default};
